class Vulnerability

	attr_accessor :name, :recommendation, :description, :severity, :asset_identifier

	def initialize(hash)
		hash.each { |k,v|
			public_send("#{k}=",clean_string(v))
		}
	end

	private
	def clean_string(string)
		h = { "  " => "", "<p>" => "", "</p>" => "", "<br>" => "", "</br>" => "",
			"<ul>" => "", "</ul>" => "", "<li>" => "", "</li>" => "", "<br/>" => "" }
		reg = Regexp.new("^#{h.keys.join('|')}$")
		string.gsub(reg,h)
	end

end

